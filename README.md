# Обновление кода ОКФС в Excel

## Описание проекта

**Обновление кода ОКФС в Excel** — это удобная утилита на языке Python, предназначенная для автоматического назначения кода ОКФС (Общероссийский классификатор форм собственности) для предприятий на основе их ИНН (идентификационного номера налогоплательщика). Скрипт обрабатывает Excel-файл, отправляет запросы к API государственного портала Росстата и обновляет соответствующие ячейки с кодом ОКФС.

## Особенности

- **Автоматизация**: Автоматически обрабатывает строки Excel и обновляет данные без необходимости ручного ввода.
- **Надежность**: Встроенные механизмы повторных попыток при ошибках запросов обеспечивают стабильную работу.
- **Удобство использования**: Прогрессивный интерфейс командной строки помогает пользователю шаг за шагом выполнить все необходимые действия.

## Требования

Перед началом работы убедитесь, что на вашем компьютере установлены следующие программы и библиотеки:

- **Python** версии 3.7 или выше. Скачать можно [здесь](https://www.python.org/downloads/).
- Установленные Python-библиотеки:
  - `openpyxl`
  - `requests`
  - `tqdm`

## Установка

1. **Установка Python**

   Если Python еще не установлен на вашем компьютере, скачайте его с официального сайта [python.org](https://www.python.org/downloads/) и следуйте инструкциям по установке для вашей операционной системы.

2. **Скачивание проекта**

   Скачайте или клонируйте репозиторий проекта на свой компьютер:

   ```bash
   git clone https://github.com/KOJIMEISTER/okfs_parse.git
   ```

   Или просто скачайте ZIP-архив и распакуйте его.

3. **Установка необходимых библиотек**

   Откройте терминал (или командную строку) и перейдите в директорию с проектом. Затем выполните команду для установки необходимых библиотек:

   ```bash
   pip install openpyxl requests tqdm
   ```

   *Если у вас несколько версий Python, возможно, придется использовать `pip3` вместо `pip`.*

## Использование

### Шаг 1: Подготовка Excel-файла

Подготовьте Excel-файл, в котором у вас есть столбец с ИНН предприятий. Убедитесь, что файл сохранен в одном из следующих форматов: `.xlsx`, `.xlsm`, `.xltx`, `.xltm`.

### Шаг 2: Запуск скрипта

1. **Открытие терминала**

   Откройте терминал (или командную строку) и перейдите в папку с проектом:

   ```bash
   cd путь/до/папки/с/проектом
   ```

2. **Запуск скрипта**

   Выполните следующую команду для запуска скрипта:

   ```bash
   python excel.py
   ```

   *Если используется Python 3 и команда `python` связана с другой версией, попробуйте `python3 excel.py`.*

### Шаг 3: Взаимодействие с программой

После запуска скрипта следуйте инструкциям, которые будут выводиться в терминале:

1. **Ввод пути к Excel-файлу**

   Программа запросит путь к вашему Excel-файлу. Введите полный путь или переместите файл в папку с проектом и укажите его название.

   ```plaintext
   Enter the path to the Excel file: C:\Users\Username\Documents\data.xlsx
   ```

2. **Выбор листа**

   Если в вашем файле несколько листов, программа покажет список доступных и предложит выбрать один по номеру.

   ```plaintext
   Available Sheets:
   1. Лист1
   2. Лист2
   Select a sheet by number: 1
   ```

3. **Указание столбцов**

   Укажите номера столбцов:
   
   - Столбец, содержащий ИНН предприятий.
   - Столбец, куда будет записываться код ОКФС.

   ```plaintext
   Enter the column number containing the taxpayer identification number: 2
   Enter the column number for writing the OKFS code: 3
   ```

4. **Указание диапазона строк**

   Введите начальный и конечный номера строк, которые необходимо обработать.

   ```plaintext
   Enter the initial line number to start reading/writing: 2
   Enter the last line number to read/write: 100
   ```

5. **Процесс обновления**

   Программа начнет обработку указанного диапазона строк, отображая прогресс выполнения.

   ```plaintext
   Processing Tax IDs: 100%|█████████████████████████████| 99/99 [12:34<00:00,  1.23tax_id/s]
   ```

6. **Завершение**

   После успешного завершения обработки вы увидите сообщение об обновлении файла.

   ```plaintext
   Workbook 'data.xlsx' has been updated successfully.
   ```

## Примечания

- **Безопасность**: Скрипт использует запросы к официальному API Росстата. Убедитесь, что у вас есть доступ к этому API и вы соблюдаете все правила и ограничения при использовании.
- **Ограничения скорости**: Для предотвращения перегрузки сервера внедрена задержка в 7.5 секунд между запросами. Не изменяйте этот параметр без необходимости.
- **Формат файла**: Убедитесь, что ваш Excel-файл сохранен в поддерживаемом формате и правильно структурирован.

## Решение проблем

- **Ошибка при загрузке Excel-файла**: Проверьте путь к файлу и его формат.
- **Отсутствие кода ОКФС**: Возможно, для некоторых ИНН отсутствуют данные в API. Проверьте корректность ИНН и доступность информации.
- **Проблемы с подключением к API**: Убедитесь, что ваше интернет-соединение активно и доступен сайт Росстата.

## Лицензия

Этот проект распространяется под лицензией [MIT](LICENSE).
