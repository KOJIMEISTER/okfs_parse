```markdown
# Excel OKFS Code Updater

![License](https://img.shields.io/badge/license-MIT-blue.svg)

## Описание проекта

**Excel OKFS Code Updater** — это удобный Python-утилита, предназначенная для автоматического обновления файлов Excel с кодами OKFS (Общероссийский классификатор форм собственности) на основе идентификационных налогоплательщиков (ИНН). Скрипт выполняет запросы к государственному API, получает необходимые данные и заполняет указанные ячейки в вашем Excel-файле.

Эта утилита идеально подходит для пользователей, которые не имеют глубоких знаний в программировании, но нуждаются в автоматизации процесса обновления данных в больших таблицах Excel.

## Возможности

- **Автоматическое обновление**: Заполняет столбец с кодами OKFS на основе ИНН.
- **Гибкость**: Возможность выбора листа, столбцов и диапазона строк для обработки.
- **Удобство использования**: Интерактивные подсказки для пошагового выполнения задачи.
- **Обработка ошибок**: Обработка различных типов ошибок, включая ограничение количества запросов.

## Требования

Перед запуском скрипта убедитесь, что на вашем компьютере установлены следующие компоненты:

- **Python**: версия 3.7 или выше
- **Библиотеки Python**:
  - `openpyxl`
  - `requests`
  - `tqdm`

## Установка

1. **Установите Python**

   Если Python еще не установлен на вашем компьютере, скачайте его с официального сайта: [python.org](https://www.python.org/downloads/) и следуйте инструкциям по установке для вашей операционной системы.

2. **Склонируйте репозиторий**

   Откройте терминал или командную строку и выполните команду:

   ```bash
   git clone https://github.com/yourusername/excel-okfs-updater.git
   ```

   *Замените `yourusername` на ваше имя пользователя GitHub, если необходимо.*

3. **Перейдите в каталог проекта**

   ```bash
   cd excel-okfs-updater
   ```

4. **Установите необходимые библиотеки**

   Выполните команду для установки зависимостей:

   ```bash
   pip install -r requirements.txt
   ```

   Если файла `requirements.txt` нет, установите библиотеки вручную:

   ```bash
   pip install openpyxl requests tqdm
   ```

## Использование

1. **Запустите скрипт**

   В терминале или командной строке выполните команду:

   ```bash
   python excel.py
   ```

2. **Следуйте инструкциям в терминале**

   Скрипт проведет вас через несколько шагов для обновления вашего Excel-файла:

   - **Введите путь к Excel-файлу**

     Введите полный путь к вашему Excel-файлу. Например:

     ```
     C:\Users\Username\Documents\data.xlsx
     ```

   - **Выберите лист**

     После загрузки файла появится список доступных листов (вкладок). Введите номер листа, который вы хотите обработать.

     ```
     Доступные листы:
     1. Лист1
     2. Лист2
     Выберите лист по номеру: 1
     ```

   - **Укажите номера столбцов**

     Укажите номера столбцов, где содержатся ИНН и куда будет записан код OKFS.

     ```
     Введите номер столбца с ИНН налогоплательщика: 2
     Введите номер столбца для записи кода OKFS: 3
     ```

     *Обратите внимание: нумерация столбцов начинается с 1.*

   - **Укажите диапазон строк**

     Введите начальную и конечную строки для обработки.

     ```
     Введите начальную строку для начала чтения/записи: 2
     Введите конечную строку для чтения/записи: 100
     ```

   - **Процесс обновления**

     Скрипт начнет обработку строк, отображая прогресс с помощью прогресс-бара. Подождите, пока процесс завершится.

3. **Проверьте обновленный файл**

   После завершения работы скрипта откройте ваш Excel-файл и убедитесь, что столбец с кодами OKFS был успешно заполнен.

## Примечания

- **Формат Excel-файла**: Убедитесь, что ваш файл имеет расширение `.xlsx`, `.xlsm`, `.xltx` или `.xltm`.
- **Скорость запросов**: Скрипт делает паузу в 7.5 секунд между запросами, чтобы избежать превышения лимита запросов к API.
- **Обработка ошибок**: В случае возникновения ошибок при запросе к API или других непредвиденных ситуаций, скрипт отобразит соответствующие сообщения.

## Решение возможных проблем

- **Ошибка подключения к интернету**: Убедитесь, что ваше устройство подключено к интернету.
- **Неверный путь к файлу**: Проверьте, что вы вводите правильный путь к существующему Excel-файлу.
- **Неверные номера столбцов или строк**: Убедитесь, что указанные номера соответствуют вашим данным в Excel.

## Вклад

Если вы обнаружили ошибку или хотите предложить улучшение, пожалуйста, создайте issue или pull request на GitHub.

## Лицензия

Этот проект лицензирован под лицензией [MIT](LICENSE).
